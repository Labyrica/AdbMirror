# Codebase Structure

**Analysis Date:** 2025-01-15

## Directory Layout

```
AdbMirror/
├── .claude/                # Claude Code configuration and GSD skill
├── .planning/              # Planning documents (generated)
│   └── codebase/          # Codebase analysis documents
├── AdbMirror/             # Main application project
│   ├── Core/              # Service layer classes
│   ├── Models/            # Domain models
│   ├── Resources/         # Embedded resources (zip files)
│   └── Assets/            # UI assets (linked from root)
├── AdbMirror.sln          # Solution file
├── build.cmd              # Debug build script
├── publish.cmd            # Release publish script
├── prepare_resources.cmd  # Package platform-tools/scrcpy as zip
├── logo.png               # Application logo
├── README.md              # User documentation
├── BUILD.md               # Build instructions
└── RELEASE.md             # Release workflow
```

## Directory Purposes

**AdbMirror/ (Project Root)**
- Purpose: Main WPF application project
- Contains: C# source files, XAML UI files, project configuration
- Key files: `App.xaml`, `MainWindow.xaml`, `MainViewModel.cs`, `AppSettings.cs`
- Subdirectories: Core/, Models/, Resources/

**AdbMirror/Core/**
- Purpose: Service layer for external tool integration
- Contains: AdbService.cs, ScrcpyService.cs, ResourceExtractor.cs, DeviceState.cs
- Key files:
  - `AdbService.cs` - ADB process wrapper, device discovery
  - `ScrcpyService.cs` - scrcpy process management
  - `ResourceExtractor.cs` - Embedded resource extraction
  - `DeviceState.cs` - Device state enumeration
- Subdirectories: None

**AdbMirror/Models/**
- Purpose: Domain model definitions
- Contains: AndroidDevice.cs
- Key files: `AndroidDevice.cs` - Represents connected Android device
- Subdirectories: None

**AdbMirror/Resources/**
- Purpose: Embedded binary resources
- Contains: platform-tools.zip, scrcpy.zip (generated by prepare_resources.cmd)
- Key files: Conditional inclusion based on file existence
- Subdirectories: None

## Key File Locations

**Entry Points:**
- `AdbMirror/App.xaml` + `App.xaml.cs` - Application entry, global exception handling
- `AdbMirror/MainWindow.xaml` + `MainWindow.xaml.cs` - Main window definition

**Configuration:**
- `AdbMirror/AdbMirror.csproj` - Project configuration, dependencies, publish settings
- `AdbMirror.sln` - Visual Studio solution file
- `AdbMirror/AppSettings.cs` - Runtime settings model

**Core Logic:**
- `AdbMirror/MainViewModel.cs` - UI state management, command handlers
- `AdbMirror/Core/AdbService.cs` - ADB device discovery and state
- `AdbMirror/Core/ScrcpyService.cs` - scrcpy process control

**Build Scripts:**
- `build.cmd` - Debug build
- `publish.cmd` - Release single-file publish
- `prepare_resources.cmd` - Bundle platform-tools/scrcpy into zips

**Documentation:**
- `README.md` - User-facing installation and usage
- `BUILD.md` - Developer build instructions
- `RELEASE.md` - Release workflow documentation

## Naming Conventions

**Files:**
- PascalCase.cs for C# source files (e.g., `MainViewModel.cs`, `AdbService.cs`)
- PascalCase.xaml for XAML files (e.g., `MainWindow.xaml`)
- lowercase.cmd for batch scripts (e.g., `build.cmd`)
- UPPERCASE.md for important docs (e.g., `README.md`, `BUILD.md`)

**Directories:**
- PascalCase for code directories (e.g., `Core/`, `Models/`)
- lowercase for tool directories (e.g., `.claude/`, `.planning/`)

**Special Patterns:**
- *.xaml.cs for XAML code-behind files
- *Service.cs for service classes
- *ViewModel.cs for view model classes

## Where to Add New Code

**New Service:**
- Implementation: `AdbMirror/Core/{ServiceName}Service.cs`
- Pattern: Follow AdbService/ScrcpyService structure
- Usage: Instantiate in MainViewModel

**New Model:**
- Implementation: `AdbMirror/Models/{ModelName}.cs`
- Pattern: POCO with init properties
- Types: Add enums to `AdbMirror/Core/` alongside DeviceState

**New Window/Dialog:**
- XAML: `AdbMirror/{WindowName}.xaml`
- Code-behind: `AdbMirror/{WindowName}.xaml.cs`
- ViewModel: `AdbMirror/{WindowName}ViewModel.cs`

**New Setting:**
- Add property to `AdbMirror/AppSettings.cs`
- Add binding in `MainWindow.xaml`
- Add ViewModel property in `MainViewModel.cs`

**Utilities:**
- If general: `AdbMirror/Core/{UtilityName}.cs`
- If UI-specific: `AdbMirror/{UtilityName}.cs`

## Special Directories

**AdbMirror/Resources/**
- Purpose: Embedded resources for self-contained deployment
- Source: Generated by `prepare_resources.cmd` from platform-tools/ and scrcpy/ folders
- Committed: No (.gitignored) - regenerated at build time

**.planning/**
- Purpose: GSD planning documents
- Source: Generated by GSD commands
- Committed: Yes (part of project documentation)

---

*Structure analysis: 2025-01-15*
*Update when directory structure changes*
